<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Order Confirmation</title>
    <link rel="stylesheet" href="/confirmation.css">
    <script src="https://www.paypal.com/sdk/js?client-id=AZAewYTqVlODzYnP7s-CKoSGIhkYd7rUHEp0WxAjlbKQyuBmwTzxDUqh75FteC31PYLwR87o48lJMrZb&currency=USD"></script>
</head>
<body>

<header>
    <div class="navbar">
        <h1>Quang Ecommerce</h1>
        <a href="/books">Continue Shopping</a>
    </div>
</header>

<main>
    <div class="confirmation-container">
        <h1>Checkout</h1>
        <p>Total: <span th:text="${order.getTotalPrice()}"></span> USD</p>

        <!-- PayPal Button Container -->
        <div id="paypal-button-container"></div>
    </div>
</main>

<footer>
    <p>&copy; 2024 Quang Ecommerce. All rights reserved.</p>
</footer>

<script>
    paypal.Buttons({
        createOrder: function (data, actions) {
            return actions.order.create({
                purchase_units: [{
                    amount: {
                        value: /* Replace with Thymeleaf dynamic total */ document.querySelector('[th\\:text]').textContent
                    }
                }]
            });
        },
        onApprove: function (data, actions) {
            return actions.order.capture().then(function (details) {
                alert('Transaction completed by ' + details.payer.name.given_name);
                window.location.href = "/order/success";
            });
        },
        onCancel: function (data) {
            alert('Payment cancelled.');
        },
        onError: function (err) {
            console.error(err);
            alert('An error occurred during the transaction.');
        }
    }).render('#paypal-button-container');
</script>

</body>
</html>
